<!DOCTYPE html>
<html>

<head>
    <title>Bulls and Cows</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="scripts/underscore.js"></script>
</head>

<body>
    <div id="container">
        <ul id="rules">
            <li>Guess a number with 4 unique digits from 1 through 9:</li>
            <li>*bulls - digits in the right place</li>
            <li>*cows - correct digits, but in the wrong place</li>
        </ul>
        <input type="text" id="input" autofocus="autofocus" placeholder="Type your guess here..." />
        <ul id="output"></ul>
    </div>
    <script>
        /**
         * Create a simple number guessing game (bulls and cows).
         * Implement a high-score list and save it in localStorage.
         */
        (function () {
            'use strict';

            var SIZE = 4,
                digits = "123456789",
                secret = _.sample(digits, SIZE),
                countGuesses = 0,
                outputBox = document.getElementById('output');

            document.getElementById('input').addEventListener('change', onGuess, false);
            console.log(secret.join(''));

            function onGuess() {
                var guess = this.value;
                if (_.intersection(guess, digits).length !== SIZE)
                    return print('Invalid guess, try again.');

                countGuesses++;
                var bulls = _.reduce(_.zip(guess, secret), function (count, p) {
                    return p[0] == p[1] ? count + 1 : count;
                }, 0);

                if (bulls == SIZE)
                    return print(guess + ': Correct, you guessed it from ' + countGuesses + ' guesses!');

                var cows = _.intersection(guess, secret).length - bulls;
                print(guess + ': ' + bulls + ' bulls, ' + cows + ' cows');
            }

            function print(text) {
                outputBox.innerHTML += '<li>' + text + '</li>'
            }

        }());
    </script>
</body>

</html>
